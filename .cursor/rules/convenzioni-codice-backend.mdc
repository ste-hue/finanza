---
globs: orti-finance-api/**/*.py
alwaysApply: false
---

# Convenzioni Codice Backend

- **File Principale**: `main.py` per API e routing; `supabase_service.py` per DB; `ai_analysis_service.py` per AI.
- **Stile**: `snake_case` per variabili/funzioni; async def per metodi I/O-bound (es. DB/AI calls).
- **Typing**: Sempre type hints (es. `def analyze_variance(self, company_id: str) -> Dict[str, Any]:`).
- **Modelli**: Pydantic `BaseModel` per request/response (validazione automatica).
- **AI**: Usa `asyncio` per analisi sequenziali; Enum per tipi (es. `AnalysisType`).
- **Env**: Load da `.env` via `load_dotenv()`; credenziali in `config.py`.
- **Errori**: Logga con `logging`; raise exceptions significative.
- **Lingua**: Commenti e stringhe utente in italiano; codice in inglese.
- **Dipendenze**: Solo da `requirements.txt`; no install runtime.